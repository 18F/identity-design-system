{% assign is_current_page = true | if_is_current_page: include.jekyll_page, include.highlight_collection_when_is_current -%}
{% assign is_current_page_in_collection = true | if_is_current_page_in_collection: include.jekyll_page -%}
<a href="{{ include.jekyll_page.url | relative_url }}" class="{% if is_current_page %}usa-current{% endif %}">
  <span>
    {{ include.text | default: include.jekyll_page.title | smartify }}
  </span>
</a>
{% unless include.flat -%}
  {% assign links = nil %}
  {% if include.links and is_current_page_in_collection -%}
    {% assign links = include.links -%}
  {% elsif include.jekyll_page.subnav and is_current_page -%}
    {% assign links = include.jekyll_page.subnav -%}
  {% endif -%}
  {% if links -%}
    <ul class="{{ include.ul_class }}">
      {%
        include nav/list.html
        links=links
        li_class=include.li_class
        ul_class=include.ul_class
        highlight_collection_when_is_current=include.highlight_collection_when_is_current
      %}
    </ul>
  {% endif -%}
{% endunless -%}
